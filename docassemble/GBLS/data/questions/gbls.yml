##### OLD YML File transitioning to main.yml format.
##### Many questions here are in shared.yml or relevant document yml
---
include:
  - docassemble.AssemblyLine:assembly_line.yml
---
metadata:
  title: |
    Letter Suite for Greater Boston Legal Services 
---
objects:
  clients: ALPeopleList.using(there_are_any=False)
  attorneys: ALPeopleList.using(there_are_any=False)
  documents: ALPeopleList
---
mandatory: True
code: |
  unit
  if document_list['Plain_Language_Retainer']:
    Plain_Language_Retainer_Document    
  if document_list['No_Contact_Letter']:
    No_Contact_Letter_Document
  if document_list['Letter_to_client_to_prepare_for_interview']:
    Letter_to_client_to_prepare_for_interview_Document    
  if document_list['Letter_to_client_sending_Discharge']:
    Letter_to_client_sending_Discharge_Document  
  if document_list['Letter_to_Client_re_Telephonic']:
    Letter_to_Client_re_Telephonic_Document    
  if document_list['Letter_to_Client_Final_Credit_Report']:
    Letter_to_Client_Final_Credit_Report_Document    
  if document_list['General_Release']:
    General_Release_Document    
  if document_list['Closing_letter']:
    Closing_letter_Document   
  if document_list['Client_Appointment_Reminder']:
    Client_Appointment_Reminder_Document    
  if document_list['Affirmative_Debt_Collection_Retainer']:
    Affirmative_Debt_Collection_Retainer_Document   
  signature_date
  gbls_download  
---
code: |
  legal_problems
  clients[0].name
  clients[0].signature
  attorneys[0].signature
  Plain_Language_Retainer_Document=True
---
#TODO: Need to stop asking user for the attorney address. It will not be on the letter. 
code: | 
  clients[0].name
  clients[0].address
  intake_complete  
  final_contact_date
  attorneys[0].name
  attorneys[0].email
  if intake_complete == True:
    case_type
  else:
    attorneys[0].signature
  No_Contact_Letter_Document=True
---
code: | 
  clients[0].address
  documents_for_interview
  Letter_to_client_to_prepare_for_interview_Document=True
---
code: | 
  clients[0].name
  attorneys[0].name
  attorneys[0].phone_number
  any_debts_not_discharged
  if any_debts_not_discharged == True:
    debts_not_discharged
  Letter_to_client_sending_Discharge_Document=True
---
#This block if for 341 Bankruptcy Meetings
code: | 
  clients[0].name
  attorneys[0].name
  attorneys[0].signature
  attorneys[0].phone_number
  appointment_date
  payment_first_date
  Letter_to_Client_re_Telephonic_Document=True
---
code: | 
  clients[0].name
  attorneys[0].name
  attorneys[0].signature
  attorneys[0].phone_number
  Letter_to_Client_Final_Credit_Report_Document=True
---
code: | 
  clients[0].name
  attorneys[0].name
  law_firm
  General_Release_Document=True
---
code: | 
  clients[0].address
  Closing_letter_Document=True
---
code: | 
  clients[0].name
  attorneys[0].name
  appointment_date
  attorneys[0].signature
  Client_Appointment_Reminder_Document=True
---
#TODO: Likely needs client signature gathered in other session/location. Need to stop asking for atty and client address. 
code: | 
  clients[0].name
  attorneys[0].name
  attorneys[0].signature
  other_parties[0].name
  Affirmative_Debt_Collection_Retainer_Document=True
---
id: select unit
question: |
  What unit are you drafting forms for?
fields: 
  - Unit: unit
    choices:
      - label: Consumer Rights Unit
        value: cru
      - label: Immigration Law Unit
        value: ilu
      - label: Family Law Unit
        value: flu
      - label: CORI & Re-Entry Unit
        value: cori
      - label: Elder, Health, and Disability Unit
        value: ehdu
      - label: Housing Unit
        value: hu
      - label: Welfare Unit
        value: wu
      - label: Employment Unit
        value: eu
      - label: Civil Legal Aid for Victims of Crime
        value: clavc
      - label: The Asian Outreach Center
        value: asc
      - label: CASLS
        value: casls
under: |
  ###Available Forms: 
  
  *Consumer Rights Unit*
    
    * Affirmative Debt Collection Retainer
    * Letter to Client Final Credit Report 
    * Letter to Client re Telephonic Meeting for 314 Bankruptcy
    * Letter to client sending Discharge 
    * Closing letter
    
  *Immigration Law Unit*
    
    * Client Appointment Reminder 
    
  *Universal Forms*
    
    * Letter to client to prepare for interview
    * No Contact Letter
    * General Release of Information 
    * Plain Language Retainer
---
id: persons name
sets:
  - clients[0].name.first
  - clients[0].name.last
  - clients[0].name.middle
  - clients[0].name.suffix
question: |
  What is the clients name? 
fields:
  - code: |
      clients[0].name_fields()
---
id: persons address
sets:
  - clients[0].address.address
  - clients[0].address.city
  - clients[0].address.zip
  - clients[0].address.unit
  - clients[0].address.state
  - clients[0].address.country
generic object: ALIndividual
question: |
  What is ${ clients[0].possessive('address') }?
fields:
  - code: |
      clients[0].address_fields(country_code=AL_DEFAULT_COUNTRY, default_state=AL_DEFAULT_STATE)
---
id: client contact info
sets:
  - cleints[0].phone_number
  - clients[0].email
generic object: ALPeopleList
question: |
  What is ${ clients[0].name.first }'s contact info?
fields:
  - Phone number: clients[0].phone_number
  - Email: clients[0].email
---
id: name of advocate
sets:
  - attorneys[0].name.first
  - attorneys[0].name.last
  - attorneys[0].name.middle
  - attorneys[0].name.suffix
generic object: ALPeopleList
question: |
  Who is the advocate drafting these documents?
fields:
  - code: |
      attorneys[0].name_fields()
---
id: advocate contact info
sets:
  - attorneys[0].phone_number
  - attorneys[0].email
generic object: ALPeopleList
question: |
  What is ${ attorneys[0].name.first }'s contact info?
fields:
  - Phone number: attorneys[0].phone_number
  - Email: attorneys[0].email
---
id: name of the other party
sets:
  - other_parties[0].name.first
  - other_parties[0].name.last
  - other_parties[0].name.middle
  - other_parties[0].name.suffix
question: |
  What is the defendant's name?
fields:
  - code: |
      other_parties[0].name_fields()
---
id: gbls document list
question: |
  Select the documents you need produced. 
fields:
  - Documents: document_list
    datatype: checkboxes
    choices: 
      - Affirmative Debt Collection Retainer: Affirmative_Debt_Collection_Retainer     
      - Appointment Reminder: Client_Appointment_Reminder
      - Client Letter - Items for Intake/Interview: Letter_to_client_to_prepare_for_interview 
      - Client Letter - Final Credit Report: Letter_to_Client_Final_Credit_Report
      - Client Letter - 314 Bankruptcy Meeting: Letter_to_Client_re_Telephonic
      - Client Letter - Bankruptcy Discharge: Letter_to_client_sending_Discharge     
      - Closing Letter: Closing_letter 
      - Release of Information: General_Release 
      - Plain Language Retainer: Plain_Language_Retainer
      - No Contact Letter: No_Contact_Letter       
    none of the above: false
---
id: legal problems
question: |
  What legal issue are you assisting with?
subquestion: |
  This will be in one of your documents.
  
  "${ clients[0].name } and GBLS agree that GBLS will provide legal help with [FIELD legal_problems]." 
fields:
  - no label: legal_problems
---
id: case type
question: |
  What is the case type?
field: case_type
dropdown:
  - Small Claims
  - Bankruptcy
---
id: letter to client to prepare for interview
question: |
  Chose the items you want the client to bring to the initial interview.
fields:
  - no label: documents_for_interview
    datatype: checkboxes
    choices:
      - Social Security Card or letter from Social Security showing your Social Security number
      - Driverâ€™s License or other Picture ID
      -	Any papers concerning debts
      -	Any papers concerning lawsuits the client is invovled in.
      -	If divorced, a copy of the divorce decree and any child support/alimony orders.
      -	Copies of  bank statements for up to a year ago.
      -	Copies of pay stubs for this year.
      -	Social Security, pension, unemployment, or any type of welfare/public benefits payments documents.
      -	Tax returns for last two years.
---
#potential issue with this. might need a variable specific to the 341 form. assuming we want context specific questions for different meetings, having a general use appointment date and time variables might be a problem.
#though could maybe add objects to specify meeting purpose and then have contextualized questions that way?
id: setting appointment date variable
question: |
  What is the date and time for the appointment?
fields:
  - Appointment date: appointment_date
    datatype: date
  - Is there a time set for the appointment yet?: time_set
    datatype: yesnoradio
  - Appointment time: appointment_time
    datatype: time
    show if: time_set
---
id: payment deadlines for 341 bankruptcy
question: |
  What are the deadlines for the each installment of the filing fee?
fields:
  - First payment: payment_first_date
    datatype: date
  - Second payment: payment_second_date
    datatype: date
  - Third payment: payment_third_date
    datatype: date
---
id: any debts not discharged
question: |
  Does the client have any debts that have not been discharged?
fields:
  - no label: any_debts_not_discharged
    datatype: yesnoradio
---
question: |
  Fill in the blanks. 
subquestion: |
  This will be on the letter you send. 
  
  "This means that you are no longer legally obligated to pay the debts we listed, but [FIELD debts_not_discharged] are not discharged debts." 
fields:
  - Debts not discharged?: debts_not_discharged
  - Are any of the remaining debts unsecured?: any_secured_debts
    datatype: yesnoradio
---
id: roi question for source of info
question: |
  What entity has the records you need access to? 
fields:
  - no label: law_firm
    hint: e.g., Somerville Housing Authority
---
code: |
  Affirmative_Debt_Collection_Retainer.enabled = document_list['Affirmative_Debt_Collection_Retainer']
---
code: |
  Client_Appointment_Reminder.enabled = document_list['Client_Appointment_Reminder']
---
code: |
  Closing_letter.enabled = document_list['Closing_letter']
---
code: |
  General_Release.enabled = document_list['General_Release']
---
code: |
  Letter_to_Client_Final_Credit_Report.enabled = document_list['Letter_to_Client_Final_Credit_Report']
---
code: |
  Letter_to_Client_re_Telephonic.enabled = document_list['Letter_to_Client_re_Telephonic']
---
code: |
  Letter_to_client_sending_Discharge.enabled = document_list['Letter_to_client_sending_Discharge']
---
code: |
  Letter_to_client_to_prepare_for_interview.enabled = document_list['Letter_to_client_to_prepare_for_interview']
---
code: |
  No_Contact_Letter.enabled = document_list['No_Contact_Letter']
---
code: |
  Plain_Language_Retainer.enabled = document_list['Plain_Language_Retainer']
---
attachments:
  - name: Affirmative Debt Collection 
    filename: Affirmative_Debt_Collection_Retainer.docx    
    variable name: Affirmative_Debt_Collection_Retainer[i]      
    skip undefined: True
    docx template file: Affirmative_Debt_Collection_Retainer.docx 
    
  - name: Client Appointment Reminder 
    filename: Client_Appointment_Reminder.docx 
    variable name: Client_Appointment_Reminder[i]      
    skip undefined: True
    docx template file: Client_Appointment_Reminder.docx
  
  - name: Closing letter GLBS LL
    filename: Closing_letter.docx   
    variable name: Closing_letter[i]     
    skip undefined: True
    docx template file: Closing_letter.docx
    
  - name: General Release 
    filename: General_Release.docx  
    variable name: General_Release[i]      
    skip undefined: True
    docx template file: General_Release.docx
    
  - name: Letter to Client Final Credit Report
    filename: Letter_to_Client_Final_Credit_Report.docx  
    variable name: Letter_to_Client_Final_Credit_Report[i]      
    skip undefined: True
    docx template file: Letter_to_Client_Final_Credit_Report.docx

  - name: Letter to Client re Telephonic
    filename: Letter_to_Client_re_Telephonic.docx  
    variable name: Letter_to_Client_re_Telephonic[i]      
    skip undefined: True
    docx template file: Letter_to_Client_re_Telephonic.docx
    
  - name: Letter to client sending Discharge
    filename: Letter_to_client_sending_Discharge.docx  
    variable name: Letter_to_client_sending_Discharge[i]      
    skip undefined: True
    docx template file: Letter_to_client_sending_Discharge.docx  
    
  - name: Letter to client to prepare for interview
    filename: Letter_to_client_to_prepare_for_interview.docx  
    variable name: Letter_to_client_to_prepare_for_interview[i]      
    skip undefined: True
    docx template file: Letter_to_client_to_prepare_for_interview.docx
    
  - name: No Contact Letter
    filename: No_Contact_Letter.docx  
    variable name: No_Contact_Letter[i]      
    skip undefined: True
    docx template file: No_Contact_Letter.docx
    
  - name: Plain Language Retainer
    filename: Plain_Language_Retainer.docx  
    variable name: Plain_Language_Retainer[i]      
    skip undefined: True
    docx template file: Plain_Language_Retainer.docx
---
objects:
  - Plain_Language_Retainer: ALDocument.using(title="Plain Language Retainer", filename="Plain_Language_Retainer.docx", has_addendum=False, default_overflow_message=AL_DEFAULT_OVERFLOW_MESSAGE)
  
  - No_Contact_Letter: ALDocument.using(title="No Contact Letter", filename="No_Contact_Letter.docx", has_addendum=False, default_overflow_message=AL_DEFAULT_OVERFLOW_MESSAGE)
  
  - Letter_to_client_to_prepare_for_interview: ALDocument.using(title="Letter to client to prepare for interview", filename="Letter_to_client_to_prepare_for_interview.docx", has_addendum=False, default_overflow_message=AL_DEFAULT_OVERFLOW_MESSAGE)
  
  - Letter_to_client_sending_Discharge: ALDocument.using(title="Letter to client sending Discharge", filename="Letter_to_client_sending_Discharge.docx", has_addendum=False, default_overflow_message=AL_DEFAULT_OVERFLOW_MESSAGE)
  
  - Letter_to_Client_re_Telephonic: ALDocument.using(title="Letter to Client re Telephonic", filename="Letter_to_Client_re_Telephonic.docx", has_addendum=False, default_overflow_message=AL_DEFAULT_OVERFLOW_MESSAGE)
  
  - Letter_to_Client_Final_Credit_Report: ALDocument.using(title="Letter to Client Final Credit Report", filename="Letter_to_Client_Final_Credit_Report.docx", has_addendum=False, default_overflow_message=AL_DEFAULT_OVERFLOW_MESSAGE)
  
  - General_Release: ALDocument.using(title="General Release ", filename="General_Release.docx", has_addendum=False, default_overflow_message=AL_DEFAULT_OVERFLOW_MESSAGE)
  
  - Closing_letter: ALDocument.using(title="Closing letter", filename="Closing_letter.docx", has_addendum=False, default_overflow_message=AL_DEFAULT_OVERFLOW_MESSAGE)
  
  - Client_Appointment_Reminder: ALDocument.using(title="Client Appointment Reminder", filename="Client_Appointment_Reminder.docx", has_addendum=False, default_overflow_message=AL_DEFAULT_OVERFLOW_MESSAGE)
  
  - Affirmative_Debt_Collection_Retainer: ALDocument.using(title="Affirmative Debt Collection", filename="Affirmative_Debt_Collection_Retainer.docx", has_addendum=False, default_overflow_message=AL_DEFAULT_OVERFLOW_MESSAGE)
  
---
objects:
 - al_court_bundle: ALDocumentBundle.using(elements=[Plain_Language_Retainer, Letter_to_client_to_prepare_for_interview, Letter_to_client_sending_Discharge, No_Contact_Letter, Letter_to_Client_re_Telephonic, Letter_to_Client_Final_Credit_Report, General_Release, Closing_letter, Client_Appointment_Reminder, Affirmative_Debt_Collection_Retainer], filename="documents.docx", title="All forms to download for your records", enabled=True) 
---
id: download documents
event: gbls_download
question: |
  All done
subquestion: |
  
  ${ al_court_bundle.download_list_html() }
  

  ${ al_court_bundle.send_button_html(show_editable_checkbox=True) }

progress: 100